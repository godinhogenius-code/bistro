@using Bistro.Models
@model Dictionary<Category, List<MenuItem>>
@{
    ViewData["Title"] = "Our Menu";

    // Image URLs for each Goan menu item - using Pexels images
    var imageUrls = new Dictionary<string, string>
    {
        // Appetizers (Jevonn Suru)
        { "Beef Chilly Fry", "https://images.pexels.com/photos/2313686/pexels-photo-2313686.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Prawn Balch√£o", "https://images.pexels.com/photos/725991/pexels-photo-725991.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Fish Cutlets", "https://images.pexels.com/photos/3655916/pexels-photo-3655916.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Chorizo Pulao Bites", "https://images.pexels.com/photos/723198/pexels-photo-723198.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Stuffed Crab", "https://images.pexels.com/photos/566345/pexels-photo-566345.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Chicken Cafreal", "https://images.pexels.com/photos/2338407/pexels-photo-2338407.jpeg?auto=compress&cs=tinysrgb&w=400" },

        // Mains (Mukhya Jevonn)
        { "Fish Curry Rice", "https://images.pexels.com/photos/3926133/pexels-photo-3926133.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Pork Vindaloo", "https://images.pexels.com/photos/2679501/pexels-photo-2679501.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Chicken Xacuti", "https://images.pexels.com/photos/2474661/pexels-photo-2474661.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Prawn Curry", "https://images.pexels.com/photos/3297882/pexels-photo-3297882.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Sorpotel", "https://images.pexels.com/photos/2673353/pexels-photo-2673353.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Crab Xec Xec", "https://images.pexels.com/photos/3843224/pexels-photo-3843224.jpeg?auto=compress&cs=tinysrgb&w=400" },

        // Drinks (Piyevpa)
        { "Kokum Sarbat", "https://images.pexels.com/photos/1194030/pexels-photo-1194030.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Sol Kadhi", "https://images.pexels.com/photos/1435735/pexels-photo-1435735.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Feni Cocktail", "https://images.pexels.com/photos/338713/pexels-photo-338713.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Fresh Coconut Water", "https://images.pexels.com/photos/1030973/pexels-photo-1030973.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Mango Lassi", "https://images.pexels.com/photos/1132558/pexels-photo-1132558.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Ginger Lime Soda", "https://images.pexels.com/photos/2109099/pexels-photo-2109099.jpeg?auto=compress&cs=tinysrgb&w=400" },

        // Desserts (Goad Jevonn)
        { "Bebinca", "https://images.pexels.com/photos/291528/pexels-photo-291528.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Dodol", "https://images.pexels.com/photos/4553036/pexels-photo-4553036.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Serradura", "https://images.pexels.com/photos/1126359/pexels-photo-1126359.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Coconut Ladoo", "https://images.pexels.com/photos/4110541/pexels-photo-4110541.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Mango Pudding", "https://images.pexels.com/photos/3026808/pexels-photo-3026808.jpeg?auto=compress&cs=tinysrgb&w=400" },
        { "Kulkuls", "https://images.pexels.com/photos/230325/pexels-photo-230325.jpeg?auto=compress&cs=tinysrgb&w=400" }
    };

    var categoryDescriptions = new Dictionary<Category, (string English, string Konkani, string KonkaniName)>
    {
        { Category.Appetizers, ("Start your Goan journey with these fiery bites", "Jevonn suru koruya!", "Jevonn Suru") },
        { Category.Mains, ("Authentic Goan curries & classics", "Pet bhor kha!", "Mukhya Jevonn") },
        { Category.Drinks, ("Refreshing tropical coolers", "Tandd korpak!", "Piyevpa") },
        { Category.Desserts, ("Sweet Goan endings", "Goadponna enjoy kor!", "Goad Jevonn") }
    };
}

<!-- Menu Hero with Baba -->
<section class="menu-hero">
    <div class="menu-hero-content">
        <p class="menu-hero-konkani">"Jevonn tayar asa!"</p>
        <h1 class="menu-hero-title">Our Menu</h1>
        <p class="menu-hero-subtitle">Fresh from Goa's coast to your plate!</p>
    </div>
    <!-- Decorative Baba in background -->
    <div class="menu-hero-baba">
        <svg viewBox="0 0 100 130" xmlns="http://www.w3.org/2000/svg" style="width: 150px; opacity: 0.15;">
            <ellipse cx="50" cy="15" rx="38" ry="12" fill="#DEB887"/>
            <ellipse cx="50" cy="10" rx="24" ry="14" fill="#F4A460"/>
            <rect x="30" y="20" width="40" height="6" fill="#E85D04"/>
            <circle cx="50" cy="52" r="28" fill="#8B5A2B"/>
            <path d="M36 48 Q43 42 50 48" stroke="#1A1A1A" stroke-width="3" fill="none"/>
            <path d="M50 48 Q57 42 64 48" stroke="#1A1A1A" stroke-width="3" fill="none"/>
            <path d="M32 62 Q42 70 50 62 Q58 70 68 62" stroke="#1A1A1A" stroke-width="4" fill="none"/>
            <path d="M38 68 Q50 82 62 68" stroke="#FFFFFF" stroke-width="3" fill="#D00000"/>
            <path d="M28 80 Q50 90 72 80 L76 125 Q50 130 24 125 Z" fill="#2D6A4F"/>
        </svg>
    </div>
</section>

<!-- Category Tabs -->
<div class="category-tabs-wrapper">
    <nav class="category-tabs">
        <a href="#appetizers" class="category-tab active">
            <span class="tab-emoji">ü¶ê</span> Appetizers
        </a>
        <a href="#mains" class="category-tab">
            <span class="tab-emoji">üê†</span> Mains
        </a>
        <a href="#drinks" class="category-tab">
            <span class="tab-emoji">ü••</span> Drinks
        </a>
        <a href="#desserts" class="category-tab">
            <span class="tab-emoji">üç∞</span> Desserts
        </a>
    </nav>
</div>

<!-- Menu Sections -->
<div class="menu-content">
    @foreach (var category in new[] { Category.Appetizers, Category.Mains, Category.Drinks, Category.Desserts })
    {
        var categoryId = category.ToString().ToLower();
        var emoji = category switch
        {
            Category.Appetizers => "ü¶ê",
            Category.Mains => "üê†",
            Category.Drinks => "ü••",
            Category.Desserts => "üç∞",
            _ => "üçΩÔ∏è"
        };

        var info = categoryDescriptions[category];

        <section id="@categoryId" class="menu-section section @(category == Category.Mains || category == Category.Desserts ? "bg-light" : "")">
            <div style="max-width: 1200px; margin: 0 auto;">
                <div class="menu-section-header">
                    <span class="menu-section-icon">@emoji</span>
                    <div class="menu-section-info">
                        <p class="menu-section-konkani">"@info.Konkani"</p>
                        <h2>@category <span class="konkani-subtitle">(@info.KonkaniName)</span></h2>
                        <p>@info.English</p>
                    </div>
                </div>

                <div class="menu-grid">
                    @foreach (var item in Model[category])
                    {
                        var imageUrl = imageUrls.ContainsKey(item.Name)
                            ? imageUrls[item.Name]
                            : "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=400&h=300&fit=crop";

                        var isPopular = item.Name == "Fish Curry Rice" || item.Name == "Pork Vindaloo" ||
                                       item.Name == "Prawn Balch√£o" || item.Name == "Bebinca" ||
                                       item.Name == "Stuffed Crab" || item.Name == "Mango Lassi";

                        var isSpicy = item.Name.Contains("Vindaloo") || item.Name.Contains("Balch√£o") ||
                                     item.Name.Contains("Chilly") || item.Name.Contains("Xacuti") ||
                                     item.Name.Contains("Cafreal") || item.Name.Contains("Sorpotel");

                        <div class="menu-card">
                            <div class="menu-card-image">
                                <img src="@imageUrl" alt="@item.Name" loading="lazy" />
                                @if (isPopular)
                                {
                                    <span class="menu-card-badge">Popular</span>
                                }
                                @if (isSpicy)
                                {
                                    <span class="menu-card-spicy">üå∂Ô∏è</span>
                                }
                                <span class="menu-card-emoji">@item.Emoji</span>
                            </div>
                            <div class="menu-card-content">
                                <h3 class="menu-card-title">@item.Name</h3>
                                <p class="menu-card-description">@item.Description</p>
                                <div class="menu-card-footer">
                                    <span class="menu-card-price">$@item.Price.ToString("F2")</span>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </section>
    }
</div>

<!-- CTA Section -->
<section class="cta-section">
    <div class="cta-baba">
        <svg viewBox="0 0 100 130" xmlns="http://www.w3.org/2000/svg">
            <!-- Straw Hat -->
            <ellipse cx="50" cy="15" rx="38" ry="12" fill="#DEB887"/>
            <ellipse cx="50" cy="10" rx="24" ry="14" fill="#F4A460"/>
            <!-- Hat Band -->
            <rect x="30" y="20" width="40" height="6" fill="#E85D04" rx="1"/>
            <!-- Face -->
            <circle cx="50" cy="52" r="28" fill="#8B5A2B"/>
            <!-- Eyes (happy/closed) -->
            <path d="M36 48 Q43 42 50 48" stroke="#1A1A1A" stroke-width="3" fill="none"/>
            <path d="M50 48 Q57 42 64 48" stroke="#1A1A1A" stroke-width="3" fill="none"/>
            <!-- Mustache -->
            <path d="M32 62 Q42 70 50 62 Q58 70 68 62" stroke="#1A1A1A" stroke-width="4" fill="none"/>
            <!-- Smile -->
            <path d="M38 68 Q50 82 62 68" stroke="#FFFFFF" stroke-width="3" fill="#D00000"/>
            <!-- Body with Floral Shirt -->
            <path d="M28 80 Q50 90 72 80 L76 125 Q50 130 24 125 Z" fill="#2D6A4F"/>
            <!-- Flowers on shirt -->
            <circle cx="38" cy="100" r="5" fill="#E85D04" opacity="0.8"/>
            <circle cx="58" cy="95" r="4" fill="#FAA307" opacity="0.8"/>
            <circle cx="48" cy="115" r="5" fill="#E85D04" opacity="0.8"/>
        </svg>
    </div>
    <p class="cta-konkani">"Yeo re, bos ani kha!"</p>
    <h2 class="cta-title">Ready to Order?</h2>
    <p class="cta-text">Give us a call and experience the taste of Goa!</p>
    <a href="tel:+15551234567" class="cta-button">
        <i class="bi bi-telephone-fill"></i> Call (555) 123-4567
    </a>
</section>

@section Scripts {
    <script>
        // Smooth scroll for category tabs
        document.querySelectorAll('.category-tab').forEach(tab => {
            tab.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                const offset = 160;
                const targetPosition = target.getBoundingClientRect().top + window.pageYOffset - offset;
                window.scrollTo({ top: targetPosition, behavior: 'smooth' });

                // Update active tab
                document.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // Update active tab on scroll
        window.addEventListener('scroll', function() {
            const sections = document.querySelectorAll('.menu-section');
            const tabs = document.querySelectorAll('.category-tab');

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 200;
                if (window.pageYOffset >= sectionTop) {
                    current = section.getAttribute('id');
                }
            });

            tabs.forEach(tab => {
                tab.classList.remove('active');
                if (tab.getAttribute('href') === '#' + current) {
                    tab.classList.add('active');
                }
            });
        });
    </script>
}
